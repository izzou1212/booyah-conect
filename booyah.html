<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booyah Connect - Free Fire Community</title>
    
    <!-- Tailwind CSS (via CDN for standalone usage) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Tailwind Config for Custom Colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            750: '#2d3748',
                            850: '#1a202c',
                            900: '#0f172a',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom scrollbar for dark theme */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a; 
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #ea580c; 
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 font-sans selection:bg-orange-500 selection:text-white">

    <!-- Navbar -->
    <nav class="bg-slate-900 border-b border-slate-800 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center gap-2 cursor-pointer" onclick="switchTab('home')">
                    <i data-lucide="flame" class="h-8 w-8 text-orange-500 fill-orange-500"></i>
                    <span class="text-2xl font-black text-white tracking-wider italic">BOOYAH<span class="text-orange-500">CONNECT</span></span>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:block">
                    <div class="mr-10 flex items-baseline space-x-4 space-x-reverse">
                        <button onclick="switchTab('home')" class="nav-btn px-3 py-2 rounded-md text-sm font-bold transition-colors duration-200 text-slate-300 hover:bg-slate-800 hover:text-white" data-target="home">الرئيسية</button>
                        <button onclick="switchTab('find-players')" class="nav-btn px-3 py-2 rounded-md text-sm font-bold transition-colors duration-200 text-slate-300 hover:bg-slate-800 hover:text-white" data-target="find-players">البحث عن لاعبين</button>
                        <button onclick="switchTab('find-clans')" class="nav-btn px-3 py-2 rounded-md text-sm font-bold transition-colors duration-200 text-slate-300 hover:bg-slate-800 hover:text-white" data-target="find-clans">البحث عن كلانات</button>
                    </div>
                </div>

                <!-- User Profile -->
                <div class="hidden md:flex items-center gap-4">
                    <button class="bg-slate-800 p-2 rounded-full hover:bg-slate-700 transition">
                        <i data-lucide="message-square" class="h-5 w-5 text-slate-300"></i>
                    </button>
                    <div class="h-8 w-8 rounded-full bg-gradient-to-tr from-yellow-400 to-orange-600 p-[2px]">
                        <div class="h-full w-full rounded-full bg-slate-900 flex items-center justify-center">
                            <span class="font-bold text-xs text-orange-500">أنا</span>
                        </div>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <div class="-mr-2 flex md:hidden">
                    <button onclick="toggleMobileMenu()" class="bg-slate-800 inline-flex items-center justify-center p-2 rounded-md text-slate-400 hover:text-white hover:bg-slate-700 focus:outline-none">
                        <i data-lucide="menu" class="h-6 w-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-slate-900 border-b border-slate-800">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button onclick="switchTab('home')" class="block w-full text-right px-3 py-2 rounded-md text-base font-medium text-slate-300 hover:bg-slate-800 hover:text-white">الرئيسية</button>
                <button onclick="switchTab('find-players')" class="block w-full text-right px-3 py-2 rounded-md text-base font-medium text-slate-300 hover:bg-slate-800 hover:text-white">البحث عن لاعبين</button>
                <button onclick="switchTab('find-clans')" class="block w-full text-right px-3 py-2 rounded-md text-base font-medium text-slate-300 hover:bg-slate-800 hover:text-white">البحث عن كلانات</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="main-content" class="fade-in">
        <!-- Content injected via JS -->
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 border-t border-slate-800 pt-12 pb-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-4 gap-8 mb-8 text-right">
            <div class="col-span-1 md:col-span-2">
                <div class="flex items-center gap-2 mb-4">
                    <i data-lucide="flame" class="h-6 w-6 text-orange-500"></i>
                    <span class="text-xl font-black text-white italic">BOOYAH<span class="text-orange-500">CONNECT</span></span>
                </div>
                <p class="text-slate-400 max-w-sm">
                    المنصة المثالية للاعبي فري فاير للتواصل والمنافسة والفوز معًا. غير تابع لشركة Garena.
                </p>
            </div>
            <div>
                <h4 class="text-white font-bold mb-4 uppercase tracking-wider">المنصة</h4>
                <ul class="space-y-2 text-slate-400">
                    <li class="hover:text-orange-500 cursor-pointer">البحث عن لاعبين</li>
                    <li class="hover:text-orange-500 cursor-pointer">البحث عن كلانات</li>
                    <li class="hover:text-orange-500 cursor-pointer">البطولات</li>
                </ul>
            </div>
            <div>
                <h4 class="text-white font-bold mb-4 uppercase tracking-wider">الدعم</h4>
                <ul class="space-y-2 text-slate-400">
                    <li class="hover:text-orange-500 cursor-pointer">مركز المساعدة</li>
                    <li class="hover:text-orange-500 cursor-pointer">القواعد</li>
                    <li class="hover:text-orange-500 cursor-pointer">الخصوصية</li>
                </ul>
            </div>
        </div>
        <div class="text-center text-slate-600 text-sm border-t border-slate-800 pt-8" dir="ltr">
            &copy; 2024 BooyahConnect. All rights reserved.
        </div>
    </footer>

    <!-- Modal Template (Hidden by default) -->
    <div id="clan-modal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 bg-black/70 backdrop-blur-sm">
        <div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl overflow-y-auto max-h-[90vh]">
            <div class="flex justify-between items-center p-6 border-b border-slate-700">
                <h3 class="text-xl font-bold text-white">تسجيل كلان جديد</h3>
                <button onclick="toggleModal(false)" class="text-slate-400 hover:text-white">
                    <i data-lucide="x" class="h-6 w-6"></i>
                </button>
            </div>
            <form id="clan-form" class="p-6 space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">اسم الكلان</label>
                        <input required id="c-name" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none" placeholder="مثال: Team Elite">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">اسم القائد</label>
                        <input required id="c-leader" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none" placeholder="اسمك">
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">المستوى</label>
                        <input id="c-level" type="number" min="1" max="10" value="1" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">النوع</label>
                        <select id="c-type" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none">
                            <option value="Casual">للمتعة (Casual)</option>
                            <option value="Competitive">تنافسي (Competitive)</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">الأعضاء</label>
                        <input id="c-members" type="number" min="1" value="1" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">السعة</label>
                        <input id="c-capacity" type="number" value="20" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-400 mb-1">الشعار (Slogan)</label>
                    <input required id="c-slogan" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none" placeholder="شعار الكلان">
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-400 mb-1">المتطلبات</label>
                    <input required id="c-req" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white focus:border-orange-500 outline-none" placeholder="الشروط">
                </div>
                <button type="submit" id="submit-btn" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 rounded-lg transition-colors flex items-center justify-center gap-2 mt-4">
                    نشر الكلان
                </button>
            </form>
        </div>
    </div>

    <!-- FIREBASE & APP LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- CONFIGURATION ---
        // Replace with your Firebase Project Config from Console
        const firebaseConfig = {
            apiKey: "AIzaSyAGDODOZ_oQQxs5ui_3H7cDSTJjGf7RhpA",
  authDomain: "booyahconnect.firebaseapp.com",
  projectId: "booyahconnect",
  storageBucket: "booyahconnect.firebasestorage.app",
  messagingSenderId: "151000395470",
  appId: "1:151000395470:web:06fa090ff2adbe24f9aa9f"
        };

        // Try to initialize Firebase
        let app, auth, db, user;
        const appId = "booyah-connect-web"; // Custom ID for the app path

        try {
            // Check if config is filled (placeholder check)
            if (firebaseConfig.apiKey !== "YOUR_API_KEY_HERE") {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                
                // Auth Listener
                onAuthStateChanged(auth, (u) => {
                    user = u;
                    if(u) console.log("User Logged In:", u.uid);
                    // Refresh current view if needed
                    if(currentTab === 'find-clans') renderClans();
                });

                // Anonymous Sign In
                signInAnonymously(auth).catch(e => console.error("Auth Error:", e));
            } else {
                console.warn("Firebase Config not set. Some features won't work.");
            }
        } catch (e) {
            console.error("Firebase Init Error:", e);
        }

        // --- MOCK DATA ---
        const players = [
            { id: 1, name: "Imortal_X", rank: "Heroic", role: "Rusher", kd: "4.5", matches: 1200, headshotRate: "45%", avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Felix", online: true, tags: ["مايك مفتوح", "CS Rank"] },
            { id: 2, name: "SniperQueen", rank: "Diamond", role: "Sniper", kd: "3.2", matches: 850, headshotRate: "60%", avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka", online: false, tags: ["بطولات", "BR"] },
            { id: 3, name: "Cap_Booyah", rank: "Grandmaster", role: "IGL", kd: "5.1", matches: 3000, headshotRate: "38%", avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=John", online: true, tags: ["لعب جاد", "Rank Push"] },
            { id: 4, name: "SilentKiller", rank: "Platinum", role: "Support", kd: "2.1", matches: 400, headshotRate: "25%", avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Bob", online: true, tags: ["للمتعة", "العربية"] },
            { id: 5, name: "Drago_AK", rank: "Heroic", role: "Rusher", kd: "3.8", matches: 1500, headshotRate: "52%", avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Drago", online: false, tags: ["هجومي", "مايك مفتوح"] },
            { id: 6, name: "LoneWolf_99", rank: "Gold", role: "Rusher", kd: "1.8", matches: 200, headshotRate: "30%", avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Wolf", online: true, tags: ["مبتدئ", "ضحك"] },
        ];

        // --- GLOBAL STATE ---
        let currentTab = 'home';
        
        // --- NAVIGATION LOGIC ---
        window.switchTab = (tab) => {
            currentTab = tab;
            
            // Update UI buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.dataset.target === tab) {
                    btn.classList.add('bg-orange-600', 'text-white');
                    btn.classList.remove('text-slate-300', 'hover:bg-slate-800');
                } else {
                    btn.classList.remove('bg-orange-600', 'text-white');
                    btn.classList.add('text-slate-300', 'hover:bg-slate-800');
                }
            });

            // Mobile menu close
            document.getElementById('mobile-menu').classList.add('hidden');

            const main = document.getElementById('main-content');
            main.innerHTML = ''; // Clear content
            
            // Render specific content
            if (tab === 'home') renderHero();
            else if (tab === 'find-players') renderPlayers();
            else if (tab === 'find-clans') renderClans();
            
            // Re-init icons
            lucide.createIcons();
        };

        window.toggleMobileMenu = () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        };

        window.toggleModal = (show) => {
            const el = document.getElementById('clan-modal');
            el.style.display = show ? 'flex' : 'none';
        };

        // --- RENDER FUNCTIONS ---

        function renderHero() {
            const html = `
                <div class="relative overflow-hidden bg-slate-900">
                    <div class="absolute inset-0">
                        <div class="absolute inset-0 bg-gradient-to-l from-slate-900 to-slate-900/80 z-10"></div>
                        <img src="https://images.unsplash.com/photo-1542751371-adc38448a05e?auto=format&fit=crop&q=80&w=2070" class="w-full h-full object-cover opacity-30 transform scale-x-[-1]">
                    </div>
                    <div class="relative z-20 max-w-7xl mx-auto py-24 px-4 sm:px-6 lg:px-8 flex flex-col items-center text-center">
                        <div class="inline-flex items-center gap-2 bg-orange-500/10 border border-orange-500/20 rounded-full px-4 py-1 mb-8">
                            <i data-lucide="crown" class="h-4 w-4 text-orange-500"></i>
                            <span class="text-orange-400 text-sm font-semibold tracking-wide uppercase">المنصة الأولى للاعبي فري فاير</span>
                        </div>
                        <h1 class="text-5xl md:text-7xl font-black text-white tracking-tighter mb-6 leading-tight">
                            اعثر على <span class="text-transparent bg-clip-text bg-gradient-to-l from-yellow-400 to-orange-600">فريق أحلامك</span>
                        </h1>
                        <p class="mt-4 max-w-2xl text-xl text-slate-400 leading-relaxed">
                            توقف عن اللعب مع العشوائيين. تواصل مع لاعبين يطابقون تصنيفك ودورك وأسلوب لعبك.
                        </p>
                        <div class="mt-10 flex gap-4">
                            <button onclick="switchTab('find-players')" class="px-8 py-4 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-lg shadow-lg shadow-orange-600/30 transition-all transform hover:scale-105 flex items-center gap-2">
                                <i data-lucide="search" class="h-5 w-5"></i> ابحث عن زملاء
                            </button>
                            <button onclick="switchTab('find-clans')" class="px-8 py-4 bg-slate-800 hover:bg-slate-700 text-white font-bold rounded-lg border border-slate-700 transition-all flex items-center gap-2">
                                <i data-lucide="shield" class="h-5 w-5"></i> إنشاء كلان
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('main-content').innerHTML = html;
        }

        function renderPlayers() {
            let cardsHtml = '';
            
            players.forEach(p => {
                const rankColor = p.rank === 'Grandmaster' ? 'text-red-500' : p.rank === 'Heroic' ? 'text-purple-400' : 'text-blue-400';
                
                cardsHtml += `
                <div class="bg-slate-800 rounded-xl overflow-hidden border border-slate-700 hover:border-orange-500/50 transition-all hover:shadow-lg text-right p-6 group">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex gap-4">
                            <div class="relative">
                                <img src="${p.avatar}" class="h-16 w-16 rounded-full bg-slate-700 border-2 border-slate-600 group-hover:border-orange-500">
                                ${p.online ? '<span class="absolute bottom-0 right-0 h-4 w-4 bg-green-500 border-2 border-slate-800 rounded-full"></span>' : ''}
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-white flex items-center gap-2">${p.name}</h3>
                                <div class="text-sm font-semibold uppercase ${rankColor}">${p.rank}</div>
                                <div class="text-xs text-slate-400 mt-1 flex items-center gap-1"><i data-lucide="target" class="h-3 w-3"></i> ${p.role}</div>
                            </div>
                        </div>
                        <div class="bg-slate-900/50 px-3 py-1 rounded text-xs text-slate-400 font-mono" dir="ltr">ID: ${p.id}8493</div>
                    </div>
                    <div class="grid grid-cols-3 gap-2 mb-4">
                        <div class="bg-slate-700/30 p-2 rounded text-center"><div class="text-xs text-slate-400">K/D</div><div class="text-lg font-bold text-white" dir="ltr">${p.kd}</div></div>
                        <div class="bg-slate-700/30 p-2 rounded text-center"><div class="text-xs text-slate-400">HS%</div><div class="text-lg font-bold text-white" dir="ltr">${p.headshotRate}</div></div>
                        <div class="bg-slate-700/30 p-2 rounded text-center"><div class="text-xs text-slate-400">Matches</div><div class="text-lg font-bold text-white" dir="ltr">${p.matches}</div></div>
                    </div>
                    <button class="w-full py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-bold flex items-center justify-center gap-2">
                        <i data-lucide="user-plus" class="h-4 w-4"></i> دعوة للفريق
                    </button>
                </div>`;
            });

            const layout = `
                <div class="max-w-7xl mx-auto px-4 py-12">
                    <div class="mb-8"><h2 class="text-3xl font-bold text-white">ابحث عن زملاء</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">${cardsHtml}</div>
                </div>
            `;
            document.getElementById('main-content').innerHTML = layout;
        }

        function renderClans() {
            const header = `
                <div class="max-w-7xl mx-auto px-4 py-12">
                    <div class="mb-8"><h2 class="text-3xl font-bold text-white">كلانات نشطة</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="clans-grid">
                        <!-- Add Button -->
                        <button onclick="toggleModal(true)" class="bg-gradient-to-br from-orange-600 to-red-700 rounded-xl p-6 flex flex-col items-center justify-center text-center text-white min-h-[300px] hover:scale-[1.02] transition-transform">
                            <div class="bg-white/10 p-4 rounded-full mb-4"><i data-lucide="plus" class="h-10 w-10 text-white"></i></div>
                            <h3 class="text-2xl font-bold mb-2">سجل كلانك</h3>
                            <p class="text-orange-100 mb-6">أدرج كلانك هنا واعثر على المجندين المثاليين.</p>
                            <span class="bg-white text-orange-600 px-6 py-2 rounded-lg font-bold">أضف منشور</span>
                        </button>
                        <!-- Loading or Content -->
                        <div id="clans-loader" class="col-span-1 md:col-span-2 flex justify-center items-center"><i data-lucide="loader-2" class="h-8 w-8 text-orange-500 animate-spin"></i></div>
                    </div>
                </div>
            `;
            document.getElementById('main-content').innerHTML = header;
            lucide.createIcons();

            // Firestore Fetch
            if (!db) {
                document.getElementById('clans-loader').innerHTML = '<p class="text-red-400">الرجاء إعداد Firebase Config لرؤية البيانات</p>';
                return;
            }

            const q = query(collection(db, 'artifacts', appId, 'public', 'data', 'clans'), orderBy('createdAt', 'desc'));
            onSnapshot(q, (snapshot) => {
                const container = document.getElementById('clans-grid');
                if(!container) return;
                
                // Remove old clan cards (keep the first button)
                const children = Array.from(container.children);
                children.slice(1).forEach(child => child.remove());

                snapshot.docs.forEach(doc => {
                    const data = doc.data();
                    const card = document.createElement('div');
                    card.className = "bg-slate-800 rounded-xl p-6 border border-slate-700 hover:border-yellow-500/50 transition-all relative overflow-hidden text-right";
                    card.innerHTML = `
                        ${data.type === 'Competitive' ? '<div class="absolute top-0 left-0 bg-yellow-600 text-white text-xs font-bold px-3 py-1 rounded-br-lg">تنافسي</div>' : ''}
                        <div class="flex items-center gap-4 mb-6">
                            <div class="h-16 w-16 bg-slate-700 rounded-lg flex items-center justify-center border border-slate-600 shrink-0"><i data-lucide="shield" class="h-8 w-8 text-slate-400"></i></div>
                            <div class="overflow-hidden">
                                <h3 class="text-xl font-bold text-white truncate">${data.name}</h3>
                                <div class="text-slate-400 text-sm">مستوى ${data.level} • القائد: <span class="text-orange-400">${data.leader}</span></div>
                            </div>
                        </div>
                        <p class="text-slate-300 italic mb-4 text-sm truncate">"${data.slogan}"</p>
                        <div class="space-y-3 mb-6">
                            <div class="flex justify-between text-sm"><span class="text-slate-400">الأعضاء</span><span class="text-white font-mono" dir="ltr">${data.members}/${data.capacity}</span></div>
                            <div class="w-full bg-slate-700 h-2 rounded-full overflow-hidden"><div class="bg-orange-500 h-full rounded-full" style="width: ${(data.members/data.capacity)*100}%"></div></div>
                            <div class="flex items-start gap-2 text-sm text-slate-400 bg-slate-900/50 p-3 rounded"><span>الشروط: ${data.requirements}</span></div>
                        </div>
                        <button class="w-full py-3 border border-slate-600 hover:border-orange-500 text-slate-300 hover:text-orange-500 rounded-lg font-bold transition-colors">طلب انضمام</button>
                    `;
                    container.appendChild(card);
                });
                lucide.createIcons();
            });
        }

        // --- FORM HANDLER ---
        document.getElementById('clan-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            if(!db || !user) {
                alert('يجب تسجيل الدخول (تهيئة Firebase) أولاً');
                return;
            }
            
            const btn = document.getElementById('submit-btn');
            btn.innerHTML = 'جاري النشر...';
            btn.disabled = true;

            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'clans'), {
                    name: document.getElementById('c-name').value,
                    leader: document.getElementById('c-leader').value,
                    level: parseInt(document.getElementById('c-level').value),
                    type: document.getElementById('c-type').value,
                    members: parseInt(document.getElementById('c-members').value),
                    capacity: parseInt(document.getElementById('c-capacity').value),
                    slogan: document.getElementById('c-slogan').value,
                    requirements: document.getElementById('c-req').value,
                    createdAt: serverTimestamp(),
                    userId: user.uid
                });
                toggleModal(false);
                document.getElementById('clan-form').reset();
            } catch (err) {
                console.error(err);
                alert('حدث خطأ');
            } finally {
                btn.innerHTML = 'نشر الكلان';
                btn.disabled = false;
            }
        });

        // Init
        renderHero();
        lucide.createIcons();

    </script>
</body>
</html>